"use strict";(self.webpackChunksample_app=self.webpackChunksample_app||[]).push([[2],{9002:(et,x,b)=>{b.r(x),b.d(x,{CombineWithEntityComponent:()=>F,mockProducts:()=>$});var N=b(9653),e=b(4650),r=(()=>{return(d=r||(r={}))[d.EntitiesOnly=0]="EntitiesOnly",d[d.Both=1]="Both",d[d.None=2]="None",r;var d})();function m(d){return function(l,f){const y={ids:[...f.ids],entities:{...f.entities}},g=d(l,y);return g===r.Both?Object.assign({},f,y):g===r.EntitiesOnly?{...f,entities:y.entities}:f}}function v(d,u){const l=u(d);return(0,e.X6Q)()&&void 0===l&&console.warn("@ngrx/entity: The entity passed to the `selectId` implementation returned undefined.","You should probably provide your own `selectId` implementation.","The entity that was passed:",d,"The `selectId` implementation:",u.toString()),l}function K(d){function u(c,i){const n=v(c,d);return n in i.entities?r.None:(i.ids.push(n),i.entities[n]=c,r.Both)}function l(c,i){let n=!1;for(const t of c)n=u(t,i)!==r.None||n;return n?r.Both:r.None}function y(c,i){const n=v(c,d);return n in i.entities?(i.entities[n]=c,r.EntitiesOnly):(i.ids.push(n),i.entities[n]=c,r.Both)}function A(c,i){const t=(c instanceof Array?c:i.ids.filter(o=>c(i.entities[o]))).filter(o=>o in i.entities).map(o=>delete i.entities[o]).length>0;return t&&(i.ids=i.ids.filter(o=>o in i.entities)),t?r.Both:r.None}function P(c,i){return B([c],i)}function B(c,i){const n={};return(c=c.filter(o=>o.id in i.entities)).length>0?c.filter(s=>function w(c,i,n){const o=Object.assign({},n.entities[i.id],i.changes),s=v(o,d),a=s!==i.id;return a&&(c[i.id]=s,delete n.entities[i.id]),n.entities[s]=o,a}(n,s,i)).length>0?(i.ids=i.ids.map(s=>n[s]||s),r.Both):r.EntitiesOnly:r.None}function S(c,i){const n=[],t=[];for(const a of c){const h=v(a,d);h in i.entities?t.push({id:h,changes:a}):n.push(a)}const o=B(t,i),s=l(n,i);switch(!0){case s===r.None&&o===r.None:return r.None;case s===r.Both||o===r.Both:return r.Both;default:return r.EntitiesOnly}}return{removeAll:function T(c){return Object.assign({},c,{ids:[],entities:{}})},addOne:m(u),addMany:m(l),setAll:m(function f(c,i){return i.ids=[],i.entities={},l(c,i),r.Both}),setOne:m(y),setMany:m(function g(c,i){const n=c.map(t=>y(t,i));switch(!0){case n.some(t=>t===r.Both):return r.Both;case n.some(t=>t===r.EntitiesOnly):return r.EntitiesOnly;default:return r.None}}),updateOne:m(P),updateMany:m(B),upsertOne:m(function j(c,i){return S([c],i)}),upsertMany:m(S),removeOne:m(function p(c,i){return A([c],i)}),removeMany:m(A),map:m(function Z(c,i){return B(i.ids.reduce((o,s)=>{const a=c(i.entities[s]);return a!==i.entities[s]&&o.push({id:s,changes:a}),o},[]).filter(({id:o})=>o in i.entities),i)}),mapOne:m(function J({map:c,id:i},n){const t=n.entities[i];return t?P({id:i,changes:c(t)},n):r.None})}}function Q(d,u){const{removeOne:l,removeMany:f,removeAll:y}=K(d);function g(n,t){return p([n],t)}function p(n,t){const o=n.filter(s=>!(v(s,d)in t.entities));return 0===o.length?r.None:(i(o,t),r.Both)}function T(n,t){const o=v(n,d);return o in t.entities?(t.ids=t.ids.filter(s=>s!==o),i([n],t),r.Both):g(n,t)}function P(n,t){return Z([n],t)}function Z(n,t){const o=[],s=n.filter(a=>function B(n,t,o){if(!(t.id in o.entities))return!1;const a=Object.assign({},o.entities[t.id],t.changes),h=v(a,d);return delete o.entities[t.id],n.push(a),h!==t.id}(o,a,t)).length>0;if(0===o.length)return r.None;{const a=t.ids,h=[];return t.ids=t.ids.filter((O,E)=>O in t.entities||(h.push(E),!1)),i(o,t),!s&&h.every(O=>t.ids[O]===a[O])?r.EntitiesOnly:r.Both}}function c(n,t){const o=[],s=[];for(const O of n){const E=v(O,d);E in t.entities?s.push({id:E,changes:O}):o.push(O)}const a=Z(s,t),h=p(o,t);switch(!0){case h===r.None&&a===r.None:return r.None;case h===r.Both||a===r.Both:return r.Both;default:return r.EntitiesOnly}}function i(n,t){n.sort(u);const o=[];let s=0,a=0;for(;s<n.length&&a<t.ids.length;){const h=n[s],O=v(h,d),E=t.ids[a];u(h,t.entities[E])<=0?(o.push(O),s++):(o.push(E),a++)}t.ids=o.concat(s<n.length?n.slice(s).map(d):t.ids.slice(a)),n.forEach((h,O)=>{t.entities[d(h)]=h})}return{removeOne:l,removeMany:f,removeAll:y,addOne:m(g),updateOne:m(P),upsertOne:m(function S(n,t){return c([n],t)}),setAll:m(function A(n,t){return t.entities={},t.ids=[],p(n,t),r.Both}),setOne:m(T),setMany:m(function w(n,t){const o=n.map(s=>T(s,t));switch(!0){case o.some(s=>s===r.Both):return r.Both;case o.some(s=>s===r.EntitiesOnly):return r.EntitiesOnly;default:return r.None}}),addMany:m(p),updateMany:m(Z),upsertMany:m(c),map:m(function J(n,t){return Z(t.ids.reduce((s,a)=>{const h=n(t.entities[a]);return h!==t.entities[a]&&s.push({id:a,changes:h}),s},[]),t)}),mapOne:m(function j({map:n,id:t},o){const s=o.entities[t];return s?P({id:t,changes:n(s)},o):r.None})}}var M=b(4006),W=b(4859),I=b(6895),U=b(7676),X=b(3336),Y=b(4144),z=b(6010),R=b(4426);function V(d,u){if(1&d){const l=e.EpF();e.TgZ(0,"div",11),e._uU(1),e.TgZ(2,"button",12),e.NdJ("click",function(){const g=e.CHM(l).$implicit,p=e.oxw();return e.KtG(p.selectProduct(g.id))}),e.TgZ(3,"mat-icon"),e._uU(4,"edit"),e.qZA()(),e.TgZ(5,"button",13),e.NdJ("click",function(){const g=e.CHM(l).$implicit,p=e.oxw();return e.KtG(p.remove(g))}),e.TgZ(6,"mat-icon"),e._uU(7,"delete"),e.qZA()()()}if(2&d){const l=u.$implicit;e.xp6(1),e.hij(" ",l.name," ")}}const C=function _(d={}){const{selectId:u,sortComparer:l}={selectId:d.selectId??(p=>p.id),sortComparer:d.sortComparer??!1},f=function H(){return{getInitialState:function d(u={}){return Object.assign({ids:[],entities:{}},u)}}}(),y=function L(){return{getSelectors:function d(u){const l=p=>p.ids,f=p=>p.entities,y=(0,N.P1)(l,f,(p,A)=>p.map(T=>A[T])),g=(0,N.P1)(l,p=>p.length);return u?{selectIds:(0,N.P1)(u,l),selectEntities:(0,N.P1)(u,f),selectAll:(0,N.P1)(u,y),selectTotal:(0,N.P1)(u,g)}:{selectIds:l,selectEntities:f,selectAll:y,selectTotal:g}}}}();return{selectId:u,sortComparer:l,...f,...y,...l?Q(u,l):K(u)}}(),{selectAll:q,selectEntities:D,selectTotal:tt}=C.getSelectors(),k=d=>({id:1,name:"",...d}),$=[k({id:1,name:"Product 1"}),k({id:2,name:"Product 2"}),k({id:3,name:"Product 3"})];class F{constructor(u){this.storeFactory=u,this.store=this.storeFactory.createComponentStore({storeName:"ENTITY_EXAMPLE",defaultState:C.getInitialState({})}),this.products$=this.store.select(q),this.productForm=new M.cw({id:new M.NI(0,{nonNullable:!0,validators:[M.kI.required]}),name:new M.NI("",{nonNullable:!0,validators:[M.kI.required]})})}ngOnInit(){this.store.setState(u=>C.setAll($,u))}selectProduct(u){this.productForm.reset(D(this.store.state)[u])}remove(u){this.store.setState(C.removeOne(u.id,this.store.state)),this.resetProductForm()}storeProduct(u){u.id?this.updateProduct(u):this.addProduct({...u,id:tt(this.store.state)+1}),this.resetProductForm()}resetProductForm(){this.productForm.reset()}addProduct(u){this.store.setState(C.addOne(u,this.store.state))}updateProduct(u){this.store.setState(C.updateOne({id:u.id,changes:u},this.store.state))}ngOnDestroy(){this.store.ngOnDestroy()}static#t=this.\u0275fac=function(l){return new(l||F)(e.Y36(R.Cn))};static#n=this.\u0275cmp=e.Xpm({type:F,selectors:[["my-app-entity-app"]],standalone:!0,features:[e.jDz],decls:23,vars:4,consts:[["title",""],["subtitle",""],["content",""],[3,"formGroup","submit"],["appearance","fill"],["matInput","","formControlName","name",1,"form-input"],["mat-icon-button","","type","submit",1,"save"],["mat-icon-button","","type","button",3,"click"],["class","product-list",4,"ngFor","ngForOf"],["actions",""],["mat-icon-button","",1,"add",3,"click"],[1,"product-list"],["mat-icon-button","",1,"edit",3,"click"],["mat-icon-button","",1,"delete",3,"click"]],template:function(l,f){1&l&&(e.TgZ(0,"my-app-ui-card")(1,"div",0),e._uU(2,"Component-Store"),e.qZA(),e.TgZ(3,"div",1),e._uU(4,"Entity Example"),e.qZA(),e.TgZ(5,"div",2)(6,"form",3),e.NdJ("submit",function(){return f.storeProduct(f.productForm.getRawValue())}),e.TgZ(7,"mat-form-field",4)(8,"mat-label"),e._uU(9,"Name"),e.qZA(),e._UZ(10,"input",5),e.qZA(),e.TgZ(11,"button",6)(12,"mat-icon"),e._uU(13,"save"),e.qZA()(),e.TgZ(14,"button",7),e.NdJ("click",function(){return f.resetProductForm()}),e.TgZ(15,"mat-icon"),e._uU(16,"cancel"),e.qZA()()(),e.YNc(17,V,8,1,"div",8),e.ALo(18,"async"),e.qZA(),e.TgZ(19,"div",9)(20,"button",10),e.NdJ("click",function(){return f.resetProductForm()}),e.TgZ(21,"mat-icon"),e._uU(22,"add"),e.qZA()()()()),2&l&&(e.xp6(6),e.Q6J("formGroup",f.productForm),e.xp6(11),e.Q6J("ngForOf",e.lcZ(18,2,f.products$)))},dependencies:[I.ez,I.sg,I.Ov,M.u5,M._Y,M.Fj,M.JJ,M.JL,M.UX,M.sg,M.u,W.ot,W.RK,X.Ps,X.Hw,z.o,U.lN,U.KE,U.hX,Y.c,Y.Nt],encapsulation:2})}}}]);