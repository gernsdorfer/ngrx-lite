"use strict";(self.webpackChunksample_app=self.webpackChunksample_app||[]).push([[734],{8734:(et,W,O)=>{O.r(W),O.d(W,{CombineWithEntityComponent:()=>tt,mockProducts:()=>Y});var _=O(4115),A=O(5620),e=O(5e3),s=(()=>{return(c=s||(s={}))[c.EntitiesOnly=0]="EntitiesOnly",c[c.Both=1]="Both",c[c.None=2]="None",s;var c})();function f(c){return function(r,m){const p={ids:[...m.ids],entities:Object.assign({},m.entities)},g=c(r,p);return g===s.Both?Object.assign({},m,p):g===s.EntitiesOnly?Object.assign(Object.assign({},m),{entities:p.entities}):m}}function v(c,l){const r=l(c);return(0,e.X6Q)()&&void 0===r&&console.warn("@ngrx/entity: The entity passed to the `selectId` implementation returned undefined.","You should probably provide your own `selectId` implementation.","The entity that was passed:",c,"The `selectId` implementation:",l.toString()),r}function J(c){function l(d,i){const n=v(d,c);return n in i.entities?s.None:(i.ids.push(n),i.entities[n]=d,s.Both)}function r(d,i){let n=!1;for(const t of d)n=l(t,i)!==s.None||n;return n?s.Both:s.None}function p(d,i){const n=v(d,c);return n in i.entities?(i.entities[n]=d,s.EntitiesOnly):(i.ids.push(n),i.entities[n]=d,s.Both)}function E(d,i){const t=(d instanceof Array?d:i.ids.filter(o=>d(i.entities[o]))).filter(o=>o in i.entities).map(o=>delete i.entities[o]).length>0;return t&&(i.ids=i.ids.filter(o=>o in i.entities)),t?s.Both:s.None}function P(d,i){return B([d],i)}function B(d,i){const n={};return(d=d.filter(o=>o.id in i.entities)).length>0?d.filter(u=>function U(d,i,n){const o=Object.assign({},n.entities[i.id],i.changes),u=v(o,c),a=u!==i.id;return a&&(d[i.id]=u,delete n.entities[i.id]),n.entities[u]=o,a}(n,u,i)).length>0?(i.ids=i.ids.map(u=>n[u]||u),s.Both):s.EntitiesOnly:s.None}function F(d,i){const n=[],t=[];for(const a of d){const h=v(a,c);h in i.entities?t.push({id:h,changes:a}):n.push(a)}const o=B(t,i),u=r(n,i);switch(!0){case u===s.None&&o===s.None:return s.None;case u===s.Both||o===s.Both:return s.Both;default:return s.EntitiesOnly}}return{removeAll:function C(d){return Object.assign({},d,{ids:[],entities:{}})},addOne:f(l),addMany:f(r),setAll:f(function m(d,i){return i.ids=[],i.entities={},r(d,i),s.Both}),setOne:f(p),setMany:f(function g(d,i){const n=d.map(t=>p(t,i));switch(!0){case n.some(t=>t===s.Both):return s.Both;case n.some(t=>t===s.EntitiesOnly):return s.EntitiesOnly;default:return s.None}}),updateOne:f(P),updateMany:f(B),upsertOne:f(function w(d,i){return F([d],i)}),upsertMany:f(F),removeOne:f(function y(d,i){return E([d],i)}),removeMany:f(E),map:f(function Z(d,i){return B(i.ids.reduce((o,u)=>{const a=d(i.entities[u]);return a!==i.entities[u]&&o.push({id:u,changes:a}),o},[]).filter(({id:o})=>o in i.entities),i)}),mapOne:f(function k({map:d,id:i},n){const t=n.entities[i];return t?P({id:i,changes:d(t)},n):s.None})}}var b=O(3075),x=O(7423),j=O(9808),S=O(4106),K=O(8099),X=O(7531),z=O(5494);function V(c,l){if(1&c){const r=e.EpF();e.TgZ(0,"div",11),e._uU(1),e.TgZ(2,"button",12),e.NdJ("click",function(){const g=e.CHM(r).$implicit,y=e.oxw();return e.KtG(y.selectProduct(g.id))}),e.TgZ(3,"mat-icon"),e._uU(4,"edit"),e.qZA()(),e.TgZ(5,"button",13),e.NdJ("click",function(){const g=e.CHM(r).$implicit,y=e.oxw();return e.KtG(y.remove(g))}),e.TgZ(6,"mat-icon"),e._uU(7,"delete"),e.qZA()()()}if(2&c){const r=l.$implicit;e.xp6(1),e.hij(" ",r.name," ")}}const T=function Q(c={}){var l,r;const{selectId:m,sortComparer:p}={selectId:null!==(l=c.selectId)&&void 0!==l?l:C=>C.id,sortComparer:null!==(r=c.sortComparer)&&void 0!==r&&r},g=function G(){return{getInitialState:function c(l={}){return Object.assign({ids:[],entities:{}},l)}}}(),y=function H(){return{getSelectors:function c(l){const r=y=>y.ids,m=y=>y.entities,p=(0,A.P1)(r,m,(y,E)=>y.map(C=>E[C])),g=(0,A.P1)(r,y=>y.length);return l?{selectIds:(0,A.P1)(l,r),selectEntities:(0,A.P1)(l,m),selectAll:(0,A.P1)(l,p),selectTotal:(0,A.P1)(l,g)}:{selectIds:r,selectEntities:m,selectAll:p,selectTotal:g}}}}(),E=p?function L(c,l){const{removeOne:r,removeMany:m,removeAll:p}=J(c);function g(n,t){return y([n],t)}function y(n,t){const o=n.filter(u=>!(v(u,c)in t.entities));return 0===o.length?s.None:(i(o,t),s.Both)}function C(n,t){const o=v(n,c);return o in t.entities?(t.ids=t.ids.filter(u=>u!==o),i([n],t),s.Both):g(n,t)}function P(n,t){return Z([n],t)}function Z(n,t){const o=[],u=n.filter(a=>function B(n,t,o){if(!(t.id in o.entities))return!1;const a=Object.assign({},o.entities[t.id],t.changes),h=v(a,c);return delete o.entities[t.id],n.push(a),h!==t.id}(o,a,t)).length>0;if(0===o.length)return s.None;{const a=t.ids,h=[];return t.ids=t.ids.filter((M,N)=>M in t.entities||(h.push(N),!1)),i(o,t),!u&&h.every(M=>t.ids[M]===a[M])?s.EntitiesOnly:s.Both}}function d(n,t){const o=[],u=[];for(const M of n){const N=v(M,c);N in t.entities?u.push({id:N,changes:M}):o.push(M)}const a=Z(u,t),h=y(o,t);switch(!0){case h===s.None&&a===s.None:return s.None;case h===s.Both||a===s.Both:return s.Both;default:return s.EntitiesOnly}}function i(n,t){n.sort(l);const o=[];let u=0,a=0;for(;u<n.length&&a<t.ids.length;){const h=n[u],M=v(h,c),N=t.ids[a];l(h,t.entities[N])<=0?(o.push(M),u++):(o.push(N),a++)}t.ids=o.concat(u<n.length?n.slice(u).map(c):t.ids.slice(a)),n.forEach((h,M)=>{t.entities[c(h)]=h})}return{removeOne:r,removeMany:m,removeAll:p,addOne:f(g),updateOne:f(P),upsertOne:f(function F(n,t){return d([n],t)}),setAll:f(function E(n,t){return t.entities={},t.ids=[],y(n,t),s.Both}),setOne:f(C),setMany:f(function U(n,t){const o=n.map(u=>C(u,t));switch(!0){case o.some(u=>u===s.Both):return s.Both;case o.some(u=>u===s.EntitiesOnly):return s.EntitiesOnly;default:return s.None}}),addMany:f(y),updateMany:f(Z),upsertMany:f(d),map:f(function k(n,t){return Z(t.ids.reduce((u,a)=>{const h=n(t.entities[a]);return h!==t.entities[a]&&u.push({id:a,changes:h}),u},[]),t)}),mapOne:f(function w({map:n,id:t},o){const u=o.entities[t];return u?P({id:t,changes:n(u)},o):s.None})}}(m,p):J(m);return Object.assign(Object.assign(Object.assign({selectId:m,sortComparer:p},g),y),E)}(),{selectAll:q,selectEntities:R,selectTotal:D}=T.getSelectors(),I=c=>Object.assign({id:1,name:""},c),Y=[I({id:1,name:"Product 1"}),I({id:2,name:"Product 2"}),I({id:3,name:"Product 3"})];let tt=(()=>{class c{constructor(r){this.storeFactory=r,this.store=this.storeFactory.createComponentStore({storeName:"ENTITY_EXAMPLE",defaultState:T.getInitialState({})}),this.products$=this.store.select(q),this.productForm=new b.cw({id:new b.NI(0,{nonNullable:!0,validators:[b.kI.required]}),name:new b.NI("",{nonNullable:!0,validators:[b.kI.required]})})}ngOnInit(){this.store.setState(r=>T.setAll(Y,r))}selectProduct(r){this.productForm.reset(R(this.store.state)[r])}remove(r){this.store.setState(T.removeOne(r.id,this.store.state)),this.resetProductForm()}storeProduct(r){r.id?this.updateProduct(r):this.addProduct(Object.assign(Object.assign({},r),{id:D(this.store.state)+1})),this.resetProductForm()}resetProductForm(){this.productForm.reset()}addProduct(r){this.store.setState(T.addOne(r,this.store.state))}updateProduct(r){this.store.setState(T.updateOne({id:r.id,changes:r},this.store.state))}ngOnDestroy(){this.store.ngOnDestroy()}}return c.\u0275fac=function(r){return new(r||c)(e.Y36(_.Cn))},c.\u0275cmp=e.Xpm({type:c,selectors:[["my-app-entity-app"]],standalone:!0,features:[e.jDz],decls:23,vars:4,consts:[["title",""],["subtitle",""],["content",""],[3,"formGroup","submit"],["appearance","fill"],["matInput","","formControlName","name",1,"form-input"],["mat-icon-button","","type","submit",1,"save"],["mat-icon-button","","type","button",3,"click"],["class","product-list",4,"ngFor","ngForOf"],["actions",""],["mat-icon-button","",1,"add",3,"click"],[1,"product-list"],["mat-icon-button","",1,"edit",3,"click"],["mat-icon-button","",1,"delete",3,"click"]],template:function(r,m){1&r&&(e.TgZ(0,"my-app-ui-card")(1,"div",0),e._uU(2,"Component-Store"),e.qZA(),e.TgZ(3,"div",1),e._uU(4,"Entity Example"),e.qZA(),e.TgZ(5,"div",2)(6,"form",3),e.NdJ("submit",function(){return m.storeProduct(m.productForm.getRawValue())}),e.TgZ(7,"mat-form-field",4)(8,"mat-label"),e._uU(9,"Name"),e.qZA(),e._UZ(10,"input",5),e.qZA(),e.TgZ(11,"button",6)(12,"mat-icon"),e._uU(13,"save"),e.qZA()(),e.TgZ(14,"button",7),e.NdJ("click",function(){return m.resetProductForm()}),e.TgZ(15,"mat-icon"),e._uU(16,"cancel"),e.qZA()()(),e.YNc(17,V,8,1,"div",8),e.ALo(18,"async"),e.qZA(),e.TgZ(19,"div",9)(20,"button",10),e.NdJ("click",function(){return m.resetProductForm()}),e.TgZ(21,"mat-icon"),e._uU(22,"add"),e.qZA()()()()),2&r&&(e.xp6(6),e.Q6J("formGroup",m.productForm),e.xp6(11),e.Q6J("ngForOf",e.lcZ(18,2,m.products$)))},dependencies:[j.ez,j.sg,j.Ov,b.u5,b._Y,b.Fj,b.JJ,b.JL,b.UX,b.sg,b.u,x.ot,x.lW,K.Ps,K.Hw,z.o,S.lN,S.KE,S.hX,X.c,X.Nt],encapsulation:2}),c})()}}]);