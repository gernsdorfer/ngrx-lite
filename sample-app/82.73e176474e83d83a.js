"use strict";(self.webpackChunksample_app=self.webpackChunksample_app||[]).push([[82],{5082:(et,W,b)=>{b.r(W),b.d(W,{CombineWithEntityComponent:()=>tt,mockProducts:()=>D});var X=b(4755),M=b(9401),x=b(1728),S=b(1511),J=b(9560),j=b(8097),C=b(8784),i=b(2223),o=(()=>((o=o||{})[o.EntitiesOnly=0]="EntitiesOnly",o[o.Both=1]="Both",o[o.None=2]="None",o))();function m(d){return function(s,f){const h={ids:[...f.ids],entities:{...f.entities}},g=d(s,h);return g===o.Both?Object.assign({},f,h):g===o.EntitiesOnly?{...f,entities:h.entities}:f}}function E(d,l){const s=l(d);return(0,i.X6Q)()&&void 0===s&&console.warn("@ngrx/entity: The entity passed to the `selectId` implementation returned undefined.","You should probably provide your own `selectId` implementation.","The entity that was passed:",d,"The `selectId` implementation:",l.toString()),s}function K(d){function l(c,e){const n=E(c,d);return n in e.entities?o.None:(e.ids.push(n),e.entities[n]=c,o.Both)}function s(c,e){let n=!1;for(const t of c)n=l(t,e)!==o.None||n;return n?o.Both:o.None}function h(c,e){const n=E(c,d);return n in e.entities?(e.entities[n]=c,o.EntitiesOnly):(e.ids.push(n),e.entities[n]=c,o.Both)}function T(c,e){const t=(c instanceof Array?c:e.ids.filter(r=>c(e.entities[r]))).filter(r=>r in e.entities).map(r=>delete e.entities[r]).length>0;return t&&(e.ids=e.ids.filter(r=>r in e.entities)),t?o.Both:o.None}function Z(c,e){return B([c],e)}function B(c,e){const n={};return(c=c.filter(r=>r.id in e.entities)).length>0?c.filter(u=>function U(c,e,n){const r=Object.assign({},n.entities[e.id],e.changes),u=E(r,d),a=u!==e.id;return a&&(c[e.id]=u,delete n.entities[e.id]),n.entities[u]=r,a}(n,u,e)).length>0?(e.ids=e.ids.map(u=>n[u]||u),o.Both):o.EntitiesOnly:o.None}function F(c,e){const n=[],t=[];for(const a of c){const y=E(a,d);y in e.entities?t.push({id:y,changes:a}):n.push(a)}const r=B(t,e),u=s(n,e);switch(!0){case u===o.None&&r===o.None:return o.None;case u===o.Both||r===o.Both:return o.Both;default:return o.EntitiesOnly}}return{removeAll:function A(c){return Object.assign({},c,{ids:[],entities:{}})},addOne:m(l),addMany:m(s),setAll:m(function f(c,e){return e.ids=[],e.entities={},s(c,e),o.Both}),setOne:m(h),setMany:m(function g(c,e){const n=c.map(t=>h(t,e));switch(!0){case n.some(t=>t===o.Both):return o.Both;case n.some(t=>t===o.EntitiesOnly):return o.EntitiesOnly;default:return o.None}}),updateOne:m(Z),updateMany:m(B),upsertOne:m(function w(c,e){return F([c],e)}),upsertMany:m(F),removeOne:m(function p(c,e){return T([c],e)}),removeMany:m(T),map:m(function P(c,e){return B(e.ids.reduce((r,u)=>{const a=c(e.entities[u]);return a!==e.entities[u]&&r.push({id:u,changes:a}),r},[]).filter(({id:r})=>r in e.entities),e)}),mapOne:m(function k({map:c,id:e},n){const t=n.entities[e];return t?Z({id:e,changes:c(t)},n):o.None})}}function Q(d,l){const{removeOne:s,removeMany:f,removeAll:h}=K(d);function g(n,t){return p([n],t)}function p(n,t){const r=n.filter(u=>!(E(u,d)in t.entities));return 0===r.length?o.None:(e(r,t),o.Both)}function A(n,t){const r=E(n,d);return r in t.entities?(t.ids=t.ids.filter(u=>u!==r),e([n],t),o.Both):g(n,t)}function Z(n,t){return P([n],t)}function P(n,t){const r=[],u=n.filter(a=>function B(n,t,r){if(!(t.id in r.entities))return!1;const a=Object.assign({},r.entities[t.id],t.changes),y=E(a,d);return delete r.entities[t.id],n.push(a),y!==t.id}(r,a,t)).length>0;if(0===r.length)return o.None;{const a=t.ids,y=[];return t.ids=t.ids.filter((O,v)=>O in t.entities||(y.push(v),!1)),e(r,t),!u&&y.every(O=>t.ids[O]===a[O])?o.EntitiesOnly:o.Both}}function c(n,t){const r=[],u=[];for(const O of n){const v=E(O,d);v in t.entities?u.push({id:v,changes:O}):r.push(O)}const a=P(u,t),y=p(r,t);switch(!0){case y===o.None&&a===o.None:return o.None;case y===o.Both||a===o.Both:return o.Both;default:return o.EntitiesOnly}}function e(n,t){n.sort(l);const r=[];let u=0,a=0;for(;u<n.length&&a<t.ids.length;){const y=n[u],O=E(y,d),v=t.ids[a];l(y,t.entities[v])<=0?(r.push(O),u++):(r.push(v),a++)}t.ids=r.concat(u<n.length?n.slice(u).map(d):t.ids.slice(a)),n.forEach((y,O)=>{t.entities[d(y)]=y})}return{removeOne:s,removeMany:f,removeAll:h,addOne:m(g),updateOne:m(Z),upsertOne:m(function F(n,t){return c([n],t)}),setAll:m(function T(n,t){return t.entities={},t.ids=[],p(n,t),o.Both}),setOne:m(A),setMany:m(function U(n,t){const r=n.map(u=>A(u,t));switch(!0){case r.some(u=>u===o.Both):return o.Both;case r.some(u=>u===o.EntitiesOnly):return o.EntitiesOnly;default:return o.None}}),addMany:m(p),updateMany:m(P),upsertMany:m(c),map:m(function k(n,t){return P(t.ids.reduce((u,a)=>{const y=n(t.entities[a]);return y!==t.entities[a]&&u.push({id:a,changes:y}),u},[]),t)}),mapOne:m(function w({map:n,id:t},r){const u=r.entities[t];return u?Z({id:t,changes:n(u)},r):o.None})}}var $=b(5653),L=b(9528);function R(d,l){if(1&d){const s=i.EpF();i.TgZ(0,"div",11),i._uU(1),i.TgZ(2,"button",12),i.NdJ("click",function(){const g=i.CHM(s).$implicit,p=i.oxw();return i.KtG(p.selectProduct(g.id))}),i.TgZ(3,"mat-icon"),i._uU(4,"edit"),i.qZA()(),i.TgZ(5,"button",13),i.NdJ("click",function(){const g=i.CHM(s).$implicit,p=i.oxw();return i.KtG(p.remove(g))}),i.TgZ(6,"mat-icon"),i._uU(7,"delete"),i.qZA()()()}if(2&d){const s=l.$implicit;i.xp6(1),i.hij(" ",s.name," ")}}const N=function _(d={}){const{selectId:l,sortComparer:s}={selectId:d.selectId??(p=>p.id),sortComparer:d.sortComparer??!1},f=function G(){return{getInitialState:function d(l={}){return Object.assign({ids:[],entities:{}},l)}}}(),h=function H(){return{getSelectors:function d(l){const s=p=>p.ids,f=p=>p.entities,h=(0,C.P1)(s,f,(p,T)=>p.map(A=>T[A])),g=(0,C.P1)(s,p=>p.length);return l?{selectIds:(0,C.P1)(l,s),selectEntities:(0,C.P1)(l,f),selectAll:(0,C.P1)(l,h),selectTotal:(0,C.P1)(l,g)}:{selectIds:s,selectEntities:f,selectAll:h,selectTotal:g}}}}();return{selectId:l,sortComparer:s,...f,...h,...s?Q(l,s):K(l)}}(),{selectAll:V,selectEntities:q,selectTotal:z}=N.getSelectors(),I=d=>({id:1,name:"",...d}),D=[I({id:1,name:"Product 1"}),I({id:2,name:"Product 2"}),I({id:3,name:"Product 3"})];let tt=(()=>{class d{constructor(s){this.storeFactory=s,this.store=this.storeFactory.createComponentStore({storeName:"ENTITY_EXAMPLE",defaultState:N.getInitialState({})}),this.products=this.store.selectSignal(V),this.productForm=new M.cw({id:new M.NI(0,{nonNullable:!0,validators:[M.kI.required]}),name:new M.NI("",{nonNullable:!0,validators:[M.kI.required]})})}ngOnInit(){this.store.setState(s=>N.setAll(D,s))}selectProduct(s){this.productForm.reset(q(this.store.state())[s])}remove(s){this.store.setState(N.removeOne(s.id,this.store.state())),this.resetProductForm()}storeProduct(s){s.id?this.updateProduct(s):this.addProduct({...s,id:z(this.store.state())+1}),this.resetProductForm()}resetProductForm(){this.productForm.reset()}addProduct(s){this.store.setState(N.addOne(s,this.store.state()))}updateProduct(s){this.store.setState(N.updateOne({id:s.id,changes:s},this.store.state()))}ngOnDestroy(){this.store.ngOnDestroy()}}return d.\u0275fac=function(s){return new(s||d)(i.Y36(L.Cn))},d.\u0275cmp=i.Xpm({type:d,selectors:[["my-app-entity-app"]],standalone:!0,features:[i.jDz],decls:22,vars:2,consts:[["title",""],["subtitle",""],["content",""],[3,"formGroup","submit"],["appearance","fill"],["matInput","","formControlName","name",1,"form-input"],["mat-icon-button","","type","submit",1,"save"],["mat-icon-button","","type","button",3,"click"],["class","product-list",4,"ngFor","ngForOf"],["actions",""],["mat-icon-button","",1,"add",3,"click"],[1,"product-list"],["mat-icon-button","",1,"edit",3,"click"],["mat-icon-button","",1,"delete",3,"click"]],template:function(s,f){1&s&&(i.TgZ(0,"my-app-ui-card")(1,"div",0),i._uU(2,"Component-Store"),i.qZA(),i.TgZ(3,"div",1),i._uU(4,"Entity Example"),i.qZA(),i.TgZ(5,"div",2)(6,"form",3),i.NdJ("submit",function(){return f.storeProduct(f.productForm.getRawValue())}),i.TgZ(7,"mat-form-field",4)(8,"mat-label"),i._uU(9,"Name"),i.qZA(),i._UZ(10,"input",5),i.qZA(),i.TgZ(11,"button",6)(12,"mat-icon"),i._uU(13,"save"),i.qZA()(),i.TgZ(14,"button",7),i.NdJ("click",function(){return f.resetProductForm()}),i.TgZ(15,"mat-icon"),i._uU(16,"cancel"),i.qZA()()(),i.YNc(17,R,8,1,"div",8),i.qZA(),i.TgZ(18,"div",9)(19,"button",10),i.NdJ("click",function(){return f.resetProductForm()}),i.TgZ(20,"mat-icon"),i._uU(21,"add"),i.qZA()()()()),2&s&&(i.xp6(6),i.Q6J("formGroup",f.productForm),i.xp6(11),i.Q6J("ngForOf",f.products()))},dependencies:[M.u5,M._Y,M.Fj,M.JJ,M.JL,M.UX,M.sg,M.u,x.ot,x.RK,J.Ps,J.Hw,$.o,S.lN,S.KE,S.hX,j.c,j.Nt,X.ax],encapsulation:2}),d})()}}]);