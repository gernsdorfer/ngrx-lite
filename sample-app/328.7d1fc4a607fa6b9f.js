"use strict";(self.webpackChunksample_app=self.webpackChunksample_app||[]).push([[328],{7328(st,V,M){M.d(V,{CombineWithEntityComponent:()=>ot});var S=M(375),O=M(9417),Y=M(8834),K=M(3203),z=M(7451),$=M(9641),U=M(6948),v=M(9640),X=M(7705),r=function(s){return s[s.EntitiesOnly=0]="EntitiesOnly",s[s.Both=1]="Both",s[s.None=2]="None",s}(r||{});function m(s){return function(u,p){const f={ids:[...p.ids],entities:{...p.entities}},h=s(u,f);return h===r.Both?Object.assign({},p,f):h===r.EntitiesOnly?{...p,entities:f.entities}:p}}function E(s,l){const u=l(s);return(0,X.naY)()&&void 0===u&&console.warn("@ngrx/entity: The entity passed to the `selectId` implementation returned undefined.","You should probably provide your own `selectId` implementation.","The entity that was passed:",s,"The `selectId` implementation:",l.toString()),u}function G(s){function l(d,e){const n=E(d,s);return n in e.entities?r.None:(e.ids.push(n),e.entities[n]=d,r.Both)}function u(d,e){let n=!1;for(const t of d)n=l(t,e)!==r.None||n;return n?r.Both:r.None}function f(d,e){const n=E(d,s);return n in e.entities?(e.entities[n]=d,r.EntitiesOnly):(e.ids.push(n),e.entities[n]=d,r.Both)}function N(d,e){const t=(d instanceof Array?d:e.ids.filter(i=>d(e.entities[i]))).filter(i=>i in e.entities).map(i=>delete e.entities[i]).length>0;return t&&(e.ids=e.ids.filter(i=>i in e.entities)),t?r.Both:r.None}function A(d,e){return C([d],e)}function C(d,e){const n={};return(d=d.filter(i=>i.id in e.entities)).length>0?d.filter(c=>function T(d,e,n){const i=Object.assign({},n.entities[e.id],e.changes),c=E(i,s),a=c!==e.id;return a&&(d[e.id]=c,delete n.entities[e.id]),n.entities[c]=i,a}(n,c,e)).length>0?(e.ids=e.ids.map(c=>n[c]||c),r.Both):r.EntitiesOnly:r.None}function I(d,e){const n=[],t=[];for(const a of d){const y=E(a,s);y in e.entities?t.push({id:y,changes:a}):n.push(a)}const i=C(t,e),c=u(n,e);switch(!0){case c===r.None&&i===r.None:return r.None;case c===r.Both||i===r.Both:return r.Both;default:return r.EntitiesOnly}}return{removeAll:function k(d){return Object.assign({},d,{ids:[],entities:{}})},addOne:m(l),addMany:m(u),setAll:m(function p(d,e){return e.ids=[],e.entities={},u(d,e),r.Both}),setOne:m(f),setMany:m(function h(d,e){const n=d.map(t=>f(t,e));switch(!0){case n.some(t=>t===r.Both):return r.Both;case n.some(t=>t===r.EntitiesOnly):return r.EntitiesOnly;default:return r.None}}),updateOne:m(A),updateMany:m(C),upsertOne:m(function w(d,e){return I([d],e)}),upsertMany:m(I),removeOne:m(function b(d,e){return N([d],e)}),removeMany:m(N),map:m(function j(d,e){return C(e.ids.reduce((i,c)=>{const a=d(e.entities[c]);return a!==e.entities[c]&&i.push({id:c,changes:a}),i},[]).filter(({id:i})=>i in e.entities),e)}),mapOne:m(function W({map:d,id:e},n){const t=n.entities[e];return t?A({id:e,changes:d(t)},n):r.None})}}function L(s,l){const{removeOne:u,removeMany:p,removeAll:f}=G(s);function h(n,t){return b([n],t)}function b(n,t){const i=n.filter(c=>!(E(c,s)in t.entities));return 0===i.length?r.None:(e(i,t),r.Both)}function k(n,t){const i=E(n,s);return i in t.entities?(t.ids=t.ids.filter(c=>c!==i),e([n],t),r.Both):h(n,t)}function A(n,t){return j([n],t)}function j(n,t){const i=[],c=n.filter(a=>function C(n,t,i){if(!(t.id in i.entities))return!1;const a=Object.assign({},i.entities[t.id],t.changes),y=E(a,s);return delete i.entities[t.id],n.push(a),y!==t.id}(i,a,t)).length>0;if(0===i.length)return r.None;{const a=t.ids,y=[];return t.ids=t.ids.filter((g,F)=>g in t.entities||(y.push(F),!1)),e(i,t),!c&&y.every(g=>t.ids[g]===a[g])?r.EntitiesOnly:r.Both}}function d(n,t){const i=[],c=[];for(const g of n){const F=E(g,s);F in t.entities?c.push({id:F,changes:g}):i.push(g)}const a=j(c,t),y=b(i,t);switch(!0){case y===r.None&&a===r.None:return r.None;case y===r.Both||a===r.Both:return r.Both;default:return r.EntitiesOnly}}function e(n,t){n.sort(l);const i=[];let c=0,a=0;for(;c<n.length&&a<t.ids.length;){const y=n[c],g=E(y,s),F=t.ids[a];l(y,t.entities[F])<=0?(i.push(g),c++):(i.push(F),a++)}t.ids=i.concat(c<n.length?n.slice(c).map(s):t.ids.slice(a)),n.forEach((y,g)=>{t.entities[s(y)]=y})}return{removeOne:u,removeMany:p,removeAll:f,addOne:m(h),updateOne:m(A),upsertOne:m(function I(n,t){return d([n],t)}),setAll:m(function N(n,t){return t.entities={},t.ids=[],b(n,t),r.Both}),setOne:m(k),setMany:m(function T(n,t){const i=n.map(c=>k(c,t));switch(!0){case i.some(c=>c===r.Both):return r.Both;case i.some(c=>c===r.EntitiesOnly):return r.EntitiesOnly;default:return r.None}}),addMany:m(b),updateMany:m(j),upsertMany:m(d),map:m(function W(n,t){return j(t.ids.reduce((c,a)=>{const y=n(t.entities[a]);return y!==t.entities[a]&&c.push({id:a,changes:y}),c},[]),t)}),mapOne:m(function w({map:n,id:t},i){const c=i.entities[t];return c?A({id:t,changes:n(c)},i):r.None})}}var Z=M(3272),o=M(5547),D=M(3848),R=M(6920);const _=(s,l)=>l.id;function q(s,l){if(1&s){const u=o.RV6();o.j41(0,"div",8),o.EFF(1),o.j41(2,"button",11),o.bIt("click",function(){const f=S.eBV(u).$implicit,h=o.XpG();return S.Njj(h.selectProduct(f.id))}),o.j41(3,"mat-icon"),o.EFF(4,"edit"),o.k0s()(),o.j41(5,"button",12),o.bIt("click",function(){const f=S.eBV(u).$implicit,h=o.XpG();return S.Njj(h.remove(f))}),o.j41(6,"mat-icon"),o.EFF(7,"delete"),o.k0s()()()}if(2&s){const u=l.$implicit;o.R7$(),o.SpI(" ",u.name," ")}}const B=function Q(s={}){const{selectId:l,sortComparer:u}={selectId:s.selectId??(b=>b.id),sortComparer:s.sortComparer??!1},p=function x(){return{getInitialState:function s(l={}){return Object.assign({ids:[],entities:{}},l)}}}(),f=function H(){return{getSelectors:function s(l){const u=b=>b.ids,p=b=>b.entities,f=(0,v.Mz)(u,p,(b,N)=>b.map(k=>N[k])),h=(0,v.Mz)(u,b=>b.length);return l?{selectIds:(0,v.Mz)(l,u),selectEntities:(0,v.Mz)(l,p),selectAll:(0,v.Mz)(l,f),selectTotal:(0,v.Mz)(l,h)}:{selectIds:u,selectEntities:p,selectAll:f,selectTotal:h}}}}();return{selectId:l,sortComparer:u,...p,...f,...u?L(l,u):G(l)}}(),{selectAll:tt,selectEntities:nt,selectTotal:et}=B.getSelectors(),P=s=>({id:1,name:"",...s}),it=[P({id:1,name:"Product 1"}),P({id:2,name:"Product 2"}),P({id:3,name:"Product 3"})];let ot=(()=>{class s{constructor(){this.storeFactory=(0,S.WQX)(U.StoreFactory),this.store=this.storeFactory.createComponentStore({storeName:"ENTITY_EXAMPLE",defaultState:B.getInitialState({})}),this.products=this.store.selectSignal(tt),this.productForm=new O.gE({id:new O.MJ(0,{nonNullable:!0,validators:[O.k0.required]}),name:new O.MJ("",{nonNullable:!0,validators:[O.k0.required]})})}ngOnInit(){this.store.setState(u=>B.setAll(it,u))}selectProduct(u){this.productForm.reset(nt(this.store.state())[u])}remove(u){this.store.setState(B.removeOne(u.id,this.store.state())),this.resetProductForm()}storeProduct(u){u.id?this.updateProduct(u):this.addProduct({...u,id:et(this.store.state())+1}),this.resetProductForm()}resetProductForm(){this.productForm.reset()}addProduct(u){this.store.setState(B.addOne(u,this.store.state()))}updateProduct(u){this.store.setState(B.updateOne({id:u.id,changes:u},this.store.state()))}ngOnDestroy(){this.store.ngOnDestroy()}static{this.\u0275fac=function(p){return new(p||s)}}static{this.\u0275cmp=o.VBU({type:s,selectors:[["my-app-entity-app"]],decls:23,vars:1,consts:[["title",""],["subtitle",""],["content",""],[3,"submit","formGroup"],["appearance","fill"],["matInput","","formControlName","name",1,"form-input"],["mat-icon-button","","type","submit",1,"save"],["mat-icon-button","","type","button",3,"click"],[1,"product-list"],["actions",""],["mat-icon-button","",1,"add",3,"click"],["mat-icon-button","",1,"edit",3,"click"],["mat-icon-button","",1,"delete",3,"click"]],template:function(p,f){1&p&&(o.j41(0,"my-app-ui-card")(1,"div",0),o.EFF(2,"Component-Store"),o.k0s(),o.j41(3,"div",1),o.EFF(4,"Entity Example"),o.k0s(),o.j41(5,"div",2)(6,"form",3),o.bIt("submit",function(){return f.storeProduct(f.productForm.getRawValue())}),o.j41(7,"mat-form-field",4)(8,"mat-label"),o.EFF(9,"Name"),o.k0s(),o.nrm(10,"input",5),o.k0s(),o.j41(11,"button",6)(12,"mat-icon"),o.EFF(13,"save"),o.k0s()(),o.j41(14,"button",7),o.bIt("click",function(){return f.resetProductForm()}),o.j41(15,"mat-icon"),o.EFF(16,"cancel"),o.k0s()()(),o.Z7z(17,q,8,1,"div",8,_),o.k0s(),o.j41(19,"div",9)(20,"button",10),o.bIt("click",function(){return f.resetProductForm()}),o.j41(21,"mat-icon"),o.EFF(22,"add"),o.k0s()()()()),2&p&&(o.R7$(6),o.Y8G("formGroup",f.productForm),o.R7$(11),o.Dyx(f.products()))},dependencies:[O.YN,O.qT,O.me,O.BC,O.cb,O.X1,O.j4,O.JD,Y.Hl,D.iY,z.m_,z.An,Z.O,K.RG,R.rl,R.nJ,$.fS,$.fg],encapsulation:2})}}return s})()}}]);