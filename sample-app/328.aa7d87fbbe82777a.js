"use strict";(self.webpackChunksample_app=self.webpackChunksample_app||[]).push([[328],{7328:(st,V,b)=>{b.r(V),b.d(V,{CombineWithEntityComponent:()=>ot,mockProducts:()=>G});var S=b(2615),E=b(9417),R=b(8834),X=b(208),$=b(6347),w=b(5651),Y=b(6948),F=b(9640),J=b(7705),r=function(c){return c[c.EntitiesOnly=0]="EntitiesOnly",c[c.Both=1]="Both",c[c.None=2]="None",c}(r||{});function m(c){return function(f,d){const y={ids:[...d.ids],entities:{...d.entities}},p=c(f,y);return p===r.Both?Object.assign({},d,y):p===r.EntitiesOnly?{...d,entities:y.entities}:d}}function g(c,a){const f=a(c);return(0,J.naY)()&&void 0===f&&console.warn("@ngrx/entity: The entity passed to the `selectId` implementation returned undefined.","You should probably provide your own `selectId` implementation.","The entity that was passed:",c,"The `selectId` implementation:",a.toString()),f}function K(c){function a(u,e){const n=g(u,c);return n in e.entities?r.None:(e.ids.push(n),e.entities[n]=u,r.Both)}function f(u,e){let n=!1;for(const t of u)n=a(t,e)!==r.None||n;return n?r.Both:r.None}function y(u,e){const n=g(u,c);return n in e.entities?(e.entities[n]=u,r.EntitiesOnly):(e.ids.push(n),e.entities[n]=u,r.Both)}function N(u,e){const t=(u instanceof Array?u:e.ids.filter(i=>u(e.entities[i]))).filter(i=>i in e.entities).map(i=>delete e.entities[i]).length>0;return t&&(e.ids=e.ids.filter(i=>i in e.entities)),t?r.Both:r.None}function A(u,e){return j([u],e)}function j(u,e){const n={};return(u=u.filter(i=>i.id in e.entities)).length>0?u.filter(s=>function T(u,e,n){const i=Object.assign({},n.entities[e.id],e.changes),s=g(i,c),l=s!==e.id;return l&&(u[e.id]=s,delete n.entities[e.id]),n.entities[s]=i,l}(n,s,e)).length>0?(e.ids=e.ids.map(s=>n[s]||s),r.Both):r.EntitiesOnly:r.None}function P(u,e){const n=[],t=[];for(const l of u){const M=g(l,c);M in e.entities?t.push({id:M,changes:l}):n.push(l)}const i=j(t,e),s=f(n,e);switch(!0){case s===r.None&&i===r.None:return r.None;case s===r.Both||i===r.Both:return r.Both;default:return r.EntitiesOnly}}return{removeAll:function C(u){return Object.assign({},u,{ids:[],entities:{}})},addOne:m(a),addMany:m(f),setAll:m(function d(u,e){return e.ids=[],e.entities={},f(u,e),r.Both}),setOne:m(y),setMany:m(function p(u,e){const n=u.map(t=>y(t,e));switch(!0){case n.some(t=>t===r.Both):return r.Both;case n.some(t=>t===r.EntitiesOnly):return r.EntitiesOnly;default:return r.None}}),updateOne:m(A),updateMany:m(j),upsertOne:m(function z(u,e){return P([u],e)}),upsertMany:m(P),removeOne:m(function h(u,e){return N([u],e)}),removeMany:m(N),map:m(function k(u,e){return j(e.ids.reduce((i,s)=>{const l=u(e.entities[s]);return l!==e.entities[s]&&i.push({id:s,changes:l}),i},[]).filter(({id:i})=>i in e.entities),e)}),mapOne:m(function W({map:u,id:e},n){const t=n.entities[e];return t?A({id:e,changes:u(t)},n):r.None})}}function L(c,a){const{removeOne:f,removeMany:d,removeAll:y}=K(c);function p(n,t){return h([n],t)}function h(n,t){const i=n.filter(s=>!(g(s,c)in t.entities));return 0===i.length?r.None:(e(i,t),r.Both)}function C(n,t){const i=g(n,c);return i in t.entities?(t.ids=t.ids.filter(s=>s!==i),e([n],t),r.Both):p(n,t)}function A(n,t){return k([n],t)}function k(n,t){const i=[],s=n.filter(l=>function j(n,t,i){if(!(t.id in i.entities))return!1;const l=Object.assign({},i.entities[t.id],t.changes),M=g(l,c);return delete i.entities[t.id],n.push(l),M!==t.id}(i,l,t)).length>0;if(0===i.length)return r.None;{const l=t.ids,M=[];return t.ids=t.ids.filter((O,v)=>O in t.entities||(M.push(v),!1)),e(i,t),!s&&M.every(O=>t.ids[O]===l[O])?r.EntitiesOnly:r.Both}}function u(n,t){const i=[],s=[];for(const O of n){const v=g(O,c);v in t.entities?s.push({id:v,changes:O}):i.push(O)}const l=k(s,t),M=h(i,t);switch(!0){case M===r.None&&l===r.None:return r.None;case M===r.Both||l===r.Both:return r.Both;default:return r.EntitiesOnly}}function e(n,t){n.sort(a);const i=[];let s=0,l=0;for(;s<n.length&&l<t.ids.length;){const M=n[s],O=g(M,c),v=t.ids[l];a(M,t.entities[v])<=0?(i.push(O),s++):(i.push(v),l++)}t.ids=i.concat(s<n.length?n.slice(s).map(c):t.ids.slice(l)),n.forEach((M,O)=>{t.entities[c(M)]=M})}return{removeOne:f,removeMany:d,removeAll:y,addOne:m(p),updateOne:m(A),upsertOne:m(function P(n,t){return u([n],t)}),setAll:m(function N(n,t){return t.entities={},t.ids=[],h(n,t),r.Both}),setOne:m(C),setMany:m(function T(n,t){const i=n.map(s=>C(s,t));switch(!0){case i.some(s=>s===r.Both):return r.Both;case i.some(s=>s===r.EntitiesOnly):return r.EntitiesOnly;default:return r.None}}),addMany:m(h),updateMany:m(k),upsertMany:m(u),map:m(function W(n,t){return k(t.ids.reduce((s,l)=>{const M=n(t.entities[l]);return M!==t.entities[l]&&s.push({id:l,changes:M}),s},[]),t)}),mapOne:m(function z({map:n,id:t},i){const s=i.entities[t];return s?A({id:t,changes:n(s)},i):r.None})}}var D=b(3272),o=b(3664),q=b(9976),U=b(9502);const _=(c,a)=>a.id;function tt(c,a){if(1&c){const f=o.RV6();o.j41(0,"div",8),o.EFF(1),o.j41(2,"button",11),o.bIt("click",function(){const y=S.eBV(f).$implicit,p=o.XpG();return S.Njj(p.selectProduct(y.id))}),o.j41(3,"mat-icon"),o.EFF(4,"edit"),o.k0s()(),o.j41(5,"button",12),o.bIt("click",function(){const y=S.eBV(f).$implicit,p=o.XpG();return S.Njj(p.remove(y))}),o.j41(6,"mat-icon"),o.EFF(7,"delete"),o.k0s()()()}if(2&c){const f=a.$implicit;o.R7$(),o.SpI(" ",f.name," ")}}const B=function Z(c={}){const{selectId:a,sortComparer:f}={selectId:c.selectId??(h=>h.id),sortComparer:c.sortComparer??!1},d=function Q(){return{getInitialState:function c(a={}){return Object.assign({ids:[],entities:{}},a)}}}(),y=function H(){return{getSelectors:function c(a){const f=h=>h.ids,d=h=>h.entities,y=(0,F.Mz)(f,d,(h,N)=>h.map(C=>N[C])),p=(0,F.Mz)(f,h=>h.length);return a?{selectIds:(0,F.Mz)(a,f),selectEntities:(0,F.Mz)(a,d),selectAll:(0,F.Mz)(a,y),selectTotal:(0,F.Mz)(a,p)}:{selectIds:f,selectEntities:d,selectAll:y,selectTotal:p}}}}();return{selectId:a,sortComparer:f,...d,...y,...f?L(a,f):K(a)}}(),{selectAll:nt,selectEntities:et,selectTotal:it}=B.getSelectors(),I=c=>({id:1,name:"",...c}),G=[I({id:1,name:"Product 1"}),I({id:2,name:"Product 2"}),I({id:3,name:"Product 3"})];let ot=(()=>{var c;class a{constructor(){this.storeFactory=(0,S.WQX)(Y.iK),this.store=this.storeFactory.createComponentStore({storeName:"ENTITY_EXAMPLE",defaultState:B.getInitialState({})}),this.products=this.store.selectSignal(nt),this.productForm=new E.gE({id:new E.MJ(0,{nonNullable:!0,validators:[E.k0.required]}),name:new E.MJ("",{nonNullable:!0,validators:[E.k0.required]})})}ngOnInit(){this.store.setState(d=>B.setAll(G,d))}selectProduct(d){this.productForm.reset(et(this.store.state())[d])}remove(d){this.store.setState(B.removeOne(d.id,this.store.state())),this.resetProductForm()}storeProduct(d){d.id?this.updateProduct(d):this.addProduct({...d,id:it(this.store.state())+1}),this.resetProductForm()}resetProductForm(){this.productForm.reset()}addProduct(d){this.store.setState(B.addOne(d,this.store.state()))}updateProduct(d){this.store.setState(B.updateOne({id:d.id,changes:d},this.store.state()))}ngOnDestroy(){this.store.ngOnDestroy()}static#t=c=()=>(this.\u0275fac=function(y){return new(y||a)},this.\u0275cmp=o.VBU({type:a,selectors:[["my-app-entity-app"]],decls:23,vars:1,consts:[["title",""],["subtitle",""],["content",""],[3,"submit","formGroup"],["appearance","fill"],["matInput","","formControlName","name",1,"form-input"],["mat-icon-button","","type","submit",1,"save"],["mat-icon-button","","type","button",3,"click"],[1,"product-list"],["actions",""],["mat-icon-button","",1,"add",3,"click"],["mat-icon-button","",1,"edit",3,"click"],["mat-icon-button","",1,"delete",3,"click"]],template:function(y,p){1&y&&(o.j41(0,"my-app-ui-card")(1,"div",0),o.EFF(2,"Component-Store"),o.k0s(),o.j41(3,"div",1),o.EFF(4,"Entity Example"),o.k0s(),o.j41(5,"div",2)(6,"form",3),o.bIt("submit",function(){return p.storeProduct(p.productForm.getRawValue())}),o.j41(7,"mat-form-field",4)(8,"mat-label"),o.EFF(9,"Name"),o.k0s(),o.nrm(10,"input",5),o.k0s(),o.j41(11,"button",6)(12,"mat-icon"),o.EFF(13,"save"),o.k0s()(),o.j41(14,"button",7),o.bIt("click",function(){return p.resetProductForm()}),o.j41(15,"mat-icon"),o.EFF(16,"cancel"),o.k0s()()(),o.Z7z(17,tt,8,1,"div",8,_),o.k0s(),o.j41(19,"div",9)(20,"button",10),o.bIt("click",function(){return p.resetProductForm()}),o.j41(21,"mat-icon"),o.EFF(22,"add"),o.k0s()()()()),2&y&&(o.R7$(6),o.Y8G("formGroup",p.productForm),o.R7$(11),o.Dyx(p.products()))},dependencies:[E.YN,E.qT,E.me,E.BC,E.cb,E.X1,E.j4,E.JD,R.Hl,q.M,$.m_,$.An,D.O,X.M,U.j,U.M,w.fS,w.fg],encapsulation:2}))}return c(),a})()}}]);