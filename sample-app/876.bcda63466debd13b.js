"use strict";(self.webpackChunksample_app=self.webpackChunksample_app||[]).push([[876],{6876:(et,x,b)=>{b.r(x),b.d(x,{CombineWithEntityComponent:()=>tt,mockProducts:()=>X});var Y=b(6814),M=b(6223),J=b(2296),S=b(9116),j=b(1175),K=b(2032),N=b(4221),i=b(9212),r=function(s){return s[s.EntitiesOnly=0]="EntitiesOnly",s[s.Both=1]="Both",s[s.None=2]="None",s}(r||{});function l(s){return function(c,f){const p={ids:[...f.ids],entities:{...f.entities}},y=s(c,p);return y===r.Both?Object.assign({},f,p):y===r.EntitiesOnly?{...f,entities:p.entities}:f}}function E(s,m){const c=m(s);return(0,i.X6Q)()&&void 0===c&&console.warn("@ngrx/entity: The entity passed to the `selectId` implementation returned undefined.","You should probably provide your own `selectId` implementation.","The entity that was passed:",s,"The `selectId` implementation:",m.toString()),c}function W(s){function m(d,e){const n=E(d,s);return n in e.entities?r.None:(e.ids.push(n),e.entities[n]=d,r.Both)}function c(d,e){let n=!1;for(const t of d)n=m(t,e)!==r.None||n;return n?r.Both:r.None}function p(d,e){const n=E(d,s);return n in e.entities?(e.entities[n]=d,r.EntitiesOnly):(e.ids.push(n),e.entities[n]=d,r.Both)}function T(d,e){const t=(d instanceof Array?d:e.ids.filter(o=>d(e.entities[o]))).filter(o=>o in e.entities).map(o=>delete e.entities[o]).length>0;return t&&(e.ids=e.ids.filter(o=>o in e.entities)),t?r.Both:r.None}function Z(d,e){return B([d],e)}function B(d,e){const n={};return(d=d.filter(o=>o.id in e.entities)).length>0?d.filter(u=>function U(d,e,n){const o=Object.assign({},n.entities[e.id],e.changes),u=E(o,s),a=u!==e.id;return a&&(d[e.id]=u,delete n.entities[e.id]),n.entities[u]=o,a}(n,u,e)).length>0?(e.ids=e.ids.map(u=>n[u]||u),r.Both):r.EntitiesOnly:r.None}function F(d,e){const n=[],t=[];for(const a of d){const g=E(a,s);g in e.entities?t.push({id:g,changes:a}):n.push(a)}const o=B(t,e),u=c(n,e);switch(!0){case u===r.None&&o===r.None:return r.None;case u===r.Both||o===r.Both:return r.Both;default:return r.EntitiesOnly}}return{removeAll:function A(d){return Object.assign({},d,{ids:[],entities:{}})},addOne:l(m),addMany:l(c),setAll:l(function f(d,e){return e.ids=[],e.entities={},c(d,e),r.Both}),setOne:l(p),setMany:l(function y(d,e){const n=d.map(t=>p(t,e));switch(!0){case n.some(t=>t===r.Both):return r.Both;case n.some(t=>t===r.EntitiesOnly):return r.EntitiesOnly;default:return r.None}}),updateOne:l(Z),updateMany:l(B),upsertOne:l(function w(d,e){return F([d],e)}),upsertMany:l(F),removeOne:l(function h(d,e){return T([d],e)}),removeMany:l(T),map:l(function P(d,e){return B(e.ids.reduce((o,u)=>{const a=d(e.entities[u]);return a!==e.entities[u]&&o.push({id:u,changes:a}),o},[]).filter(({id:o})=>o in e.entities),e)}),mapOne:l(function k({map:d,id:e},n){const t=n.entities[e];return t?Z({id:e,changes:d(t)},n):r.None})}}function _(s,m){const{removeOne:c,removeMany:f,removeAll:p}=W(s);function y(n,t){return h([n],t)}function h(n,t){const o=n.filter(u=>!(E(u,s)in t.entities));return 0===o.length?r.None:(e(o,t),r.Both)}function A(n,t){const o=E(n,s);return o in t.entities?(t.ids=t.ids.filter(u=>u!==o),e([n],t),r.Both):y(n,t)}function Z(n,t){return P([n],t)}function P(n,t){const o=[],u=n.filter(a=>function B(n,t,o){if(!(t.id in o.entities))return!1;const a=Object.assign({},o.entities[t.id],t.changes),g=E(a,s);return delete o.entities[t.id],n.push(a),g!==t.id}(o,a,t)).length>0;if(0===o.length)return r.None;{const a=t.ids,g=[];return t.ids=t.ids.filter((O,v)=>O in t.entities||(g.push(v),!1)),e(o,t),!u&&g.every(O=>t.ids[O]===a[O])?r.EntitiesOnly:r.Both}}function d(n,t){const o=[],u=[];for(const O of n){const v=E(O,s);v in t.entities?u.push({id:v,changes:O}):o.push(O)}const a=P(u,t),g=h(o,t);switch(!0){case g===r.None&&a===r.None:return r.None;case g===r.Both||a===r.Both:return r.Both;default:return r.EntitiesOnly}}function e(n,t){n.sort(m);const o=[];let u=0,a=0;for(;u<n.length&&a<t.ids.length;){const g=n[u],O=E(g,s),v=t.ids[a];m(g,t.entities[v])<=0?(o.push(O),u++):(o.push(v),a++)}t.ids=o.concat(u<n.length?n.slice(u).map(s):t.ids.slice(a)),n.forEach((g,O)=>{t.entities[s(g)]=g})}return{removeOne:c,removeMany:f,removeAll:p,addOne:l(y),updateOne:l(Z),upsertOne:l(function F(n,t){return d([n],t)}),setAll:l(function T(n,t){return t.entities={},t.ids=[],h(n,t),r.Both}),setOne:l(A),setMany:l(function U(n,t){const o=n.map(u=>A(u,t));switch(!0){case o.some(u=>u===r.Both):return r.Both;case o.some(u=>u===r.EntitiesOnly):return r.EntitiesOnly;default:return r.None}}),addMany:l(h),updateMany:l(P),upsertMany:l(d),map:l(function k(n,t){return P(t.ids.reduce((u,a)=>{const g=n(t.entities[a]);return g!==t.entities[a]&&u.push({id:a,changes:g}),u},[]),t)}),mapOne:l(function w({map:n,id:t},o){const u=o.entities[t];return u?Z({id:t,changes:n(u)},o):r.None})}}var L=b(7238),R=b(9934);function V(s,m){if(1&s){const c=i.EpF();i.TgZ(0,"div",11),i._uU(1),i.TgZ(2,"button",12),i.NdJ("click",function(){const y=i.CHM(c).$implicit,h=i.oxw();return i.KtG(h.selectProduct(y.id))}),i.TgZ(3,"mat-icon"),i._uU(4,"edit"),i.qZA()(),i.TgZ(5,"button",13),i.NdJ("click",function(){const y=i.CHM(c).$implicit,h=i.oxw();return i.KtG(h.remove(y))}),i.TgZ(6,"mat-icon"),i._uU(7,"delete"),i.qZA()()()}if(2&s){const c=m.$implicit;i.xp6(1),i.hij(" ",c.name," ")}}const C=function $(s={}){const{selectId:m,sortComparer:c}={selectId:s.selectId??(h=>h.id),sortComparer:s.sortComparer??!1},f=function H(){return{getInitialState:function s(m={}){return Object.assign({ids:[],entities:{}},m)}}}(),p=function Q(){return{getSelectors:function s(m){const c=h=>h.ids,f=h=>h.entities,p=(0,N.P1)(c,f,(h,T)=>h.map(A=>T[A])),y=(0,N.P1)(c,h=>h.length);return m?{selectIds:(0,N.P1)(m,c),selectEntities:(0,N.P1)(m,f),selectAll:(0,N.P1)(m,p),selectTotal:(0,N.P1)(m,y)}:{selectIds:c,selectEntities:f,selectAll:p,selectTotal:y}}}}();return{selectId:m,sortComparer:c,...f,...p,...c?_(m,c):W(m)}}(),{selectAll:q,selectEntities:z,selectTotal:D}=C.getSelectors(),I=s=>({id:1,name:"",...s}),X=[I({id:1,name:"Product 1"}),I({id:2,name:"Product 2"}),I({id:3,name:"Product 3"})];let tt=(()=>{class s{constructor(c){this.storeFactory=c,this.store=this.storeFactory.createComponentStore({storeName:"ENTITY_EXAMPLE",defaultState:C.getInitialState({})}),this.products=this.store.selectSignal(q),this.productForm=new M.cw({id:new M.NI(0,{nonNullable:!0,validators:[M.kI.required]}),name:new M.NI("",{nonNullable:!0,validators:[M.kI.required]})})}ngOnInit(){this.store.setState(c=>C.setAll(X,c))}selectProduct(c){this.productForm.reset(z(this.store.state())[c])}remove(c){this.store.setState(C.removeOne(c.id,this.store.state())),this.resetProductForm()}storeProduct(c){c.id?this.updateProduct(c):this.addProduct({...c,id:D(this.store.state())+1}),this.resetProductForm()}resetProductForm(){this.productForm.reset()}addProduct(c){this.store.setState(C.addOne(c,this.store.state()))}updateProduct(c){this.store.setState(C.updateOne({id:c.id,changes:c},this.store.state()))}ngOnDestroy(){this.store.ngOnDestroy()}static#t=this.\u0275fac=function(f){return new(f||s)(i.Y36(R.Cn))};static#n=this.\u0275cmp=i.Xpm({type:s,selectors:[["my-app-entity-app"]],standalone:!0,features:[i.jDz],decls:22,vars:2,consts:[["title",""],["subtitle",""],["content",""],[3,"formGroup","submit"],["appearance","fill"],["matInput","","formControlName","name",1,"form-input"],["mat-icon-button","","type","submit",1,"save"],["mat-icon-button","","type","button",3,"click"],["class","product-list",4,"ngFor","ngForOf"],["actions",""],["mat-icon-button","",1,"add",3,"click"],[1,"product-list"],["mat-icon-button","",1,"edit",3,"click"],["mat-icon-button","",1,"delete",3,"click"]],template:function(f,p){1&f&&(i.TgZ(0,"my-app-ui-card")(1,"div",0),i._uU(2,"Component-Store"),i.qZA(),i.TgZ(3,"div",1),i._uU(4,"Entity Example"),i.qZA(),i.TgZ(5,"div",2)(6,"form",3),i.NdJ("submit",function(){return p.storeProduct(p.productForm.getRawValue())}),i.TgZ(7,"mat-form-field",4)(8,"mat-label"),i._uU(9,"Name"),i.qZA(),i._UZ(10,"input",5),i.qZA(),i.TgZ(11,"button",6)(12,"mat-icon"),i._uU(13,"save"),i.qZA()(),i.TgZ(14,"button",7),i.NdJ("click",function(){return p.resetProductForm()}),i.TgZ(15,"mat-icon"),i._uU(16,"cancel"),i.qZA()()(),i.YNc(17,V,8,1,"div",8),i.qZA(),i.TgZ(18,"div",9)(19,"button",10),i.NdJ("click",function(){return p.resetProductForm()}),i.TgZ(20,"mat-icon"),i._uU(21,"add"),i.qZA()()()()),2&f&&(i.xp6(6),i.Q6J("formGroup",p.productForm),i.xp6(11),i.Q6J("ngForOf",p.products()))},dependencies:[M.u5,M._Y,M.Fj,M.JJ,M.JL,M.UX,M.sg,M.u,J.ot,J.RK,j.Ps,j.Hw,L.o,S.lN,S.KE,S.hX,K.c,K.Nt,Y.ax],encapsulation:2})}return s})()}}]);